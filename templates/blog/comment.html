{% extends "base/diary_base.html" %}
{% load comment_tags %}
{% block body %}

<div class="media-content reply-indented">
    <div class="content">
        <p>
            <strong>{{ comment.name }}</strong>
            {% if comment.parent %}
            >>> <strong>{{ comment.parent.name }}</strong>
            {% endif %}
            <small>{{ comment.posted_date }}</small>
            <br>{{ comment.body }}
        </p>
    </div>

    <!-- 返信ボタン -->
    <button class="show-reply-button" onclick="showReplyForm({{ comment.id }})">返信</button>

    <!-- 返信フォーム -->
    <div id="reply-form-{{ comment.id }}" class="reply-form" style="display:none;">
        <p>返信先: <strong>{{ comment.name }}</strong></p>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <input type="hidden" name="parent_comment" value="{{ comment.id }}">
            <button class="button is-small is-success">返信を送信</button>
        </form>
    </div>

    <!-- 子コメントを再帰的に表示 -->
    {% for reply in comment.replies.all %}
    {% render_comment_tree reply %}
    {% endfor %}
</div>

{% endblock %}