{% extends "base/diary_base.html" %}
{% load youtube_extras %}
{% load static %}

{% block body %}
<link rel="stylesheet" href="{% static 'blog/css/blog.css' %}">


<h2>å£ã‚’é–‹ã</h2>
<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">å£ã‚’ã¨ã˜ã‚‹</button>
    <br>
    <div class="notification is-light">
        <strong>ğŸ“º YouTubeå‹•ç”»ã®è²¼ã‚Šæ–¹</strong><br>
        â‘  YouTubeã§å‹•ç”»ã‚’é–‹ã<br>
        â‘¡ ã€Œå…±æœ‰ã€ã‚’æŠ¼ã™<br>
        â‘¢ è¡¨ç¤ºã•ã‚ŒãŸURLã‚’ã‚³ãƒ”ãƒ¼<br>
        â‘£ ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ï¼ˆé™å®šå…¬é–‹ã§ã‚‚OKï¼‰
    </div>
    <br>
</form>

{% for post in posts %}

<a href="{% url 'blog:post_detail' slug=post.slug %}">{{ post.title }}</a>

<div class="post block">
    <!-- æŠ•ç¨¿è€…å -->
    <p><strong>æŠ•ç¨¿è€…: </strong>{{ post.name }}</p>

    <h2 class="subtitle">{{ post.title }}</h2>
    <small>Posted at {{ post.posted_date }}</small>

<p>{{ post.body|truncatechars:120 }}</p>

    <!-- ğŸ”½ ç”»åƒã‚µãƒ ãƒ -->
    {% if post.image and post.image.name %}
    <img src="{{ post.image.url }}" class="comment-media-thumb">
    {% endif %}

    <!-- ğŸ”½ å‹•ç”»ã‚µãƒ ãƒ -->
    {% if post.video_url %}
    
    {# YouTube #}
    {% if "youtube.com" in post.video_url or "youtube" in post.video_url %}
    <iframe width="100%" height="315"
        src="https://www.youtube.com/embed/{{ post.video_url|cut:'https://youtube/'|cut:'https://www.youtube.com/watch?v=' }}"
        frameborder="0" allowfullscreen>
    </iframe>
    
    {# TikTok #}
    {% elif "tiktok.com" in post.video_url %}
    <blockquote class="tiktok-embed" cite="{{ post.video_url }}"></blockquote>
    <script async src="https://www.tiktok.com/embed.js"></script>
    
    {# Instagram #}
    {% elif "instagram.com" in post.video_url %}
    <blockquote class="instagram-media" data-instagram-permalink="{{ post.video_url }}">
    </blockquote>
    <script async src="//www.instagram.com/embed.js"></script>
    
    {# X (Twitter) #}
    {% elif "x.com" in post.video_url or "twitter.com" in post.video_url %}
    <blockquote class="twitter-tweet">
        <a href="{{ post.video_url }}"></a>
    </blockquote>
    <script async src="https://platform.twitter.com/widgets.js"></script>
    
    {# Facebook #}
    {% elif "facebook.com" in post.video_url %}
    <iframe src="https://www.facebook.com/plugins/video.php?href={{ post.video_url }}" width="100%" height="315"
        style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowfullscreen>
    </iframe>
    
    {% endif %}

    <br>
    <a href="{% url 'blog:post_detail' slug=post.slug %}">ã‚‚ã£ã¨èª­ã‚€</a>
</div>

{% endfor %}

<!-- ğŸ”½ ãƒ¡ãƒ‡ã‚£ã‚¢è¡¨ç¤ºç”¨ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆå¿…é ˆï¼‰ -->
<div id="media-modal" class="media-modal" onclick="closeMedia()">
    <div id="media-content"></div>
</div>

<script src="{% static 'blog/js/blog.js' %}"></script>

{% endblock %}